#!/usr/bin/env python

import argparse
import json
from ln import backend
from ln import server

commands = {
    'start': server.start
}

def main():
    parser = argparse.ArgumentParser(description='Natural Log server')
    parser.add_argument('--config', '-c', required=True,
                        help='Path to JSON configuration file')
    subparsers = parser.add_subparsers(title='Commands', dest='command')

    for command, fcn in commands.items():
        doc = fcn.__doc__.split('\n')[0]
        subparsers.add_parser(command, help=doc)

    args = parser.parse_args()

    with open(args.config, 'r') as f:
        configuration = json.load(f)

    commands[args.command](configuration)


if __name__ == '__main__':
    main()


